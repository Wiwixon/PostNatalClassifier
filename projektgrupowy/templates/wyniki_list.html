{% extends 'base.html' %}

{% block title %}Statystyki odpowiedzi{% endblock %}

{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Statystyki odpowiedzi</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        .response-stats {
            text-align: center;
            margin-top: 100px; /* Dodatkowy odstęp na górze */
            position: relative; /* Zmień na relative */
            z-index: 1;
        }
        canvas {
            max-width: 300px;
            height: auto;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="response-stats">
        <h2>Statystyki odpowiedzi</h2>
        <canvas id="wiekChart"></canvas>
        <canvas id="poczucieSmutkuChart"></canvas>
        <canvas id="nerwoweZachowanieChart"></canvas>
        <canvas id="problemyZeSpaniemChart"></canvas>
        <canvas id="problemyZKoncentracjaChart"></canvas>
        <canvas id="przejadanieSieChart"></canvas>
        <canvas id="poczucieWinyChart"></canvas>
        <canvas id="problemZPrzywiazaniemChart"></canvas>
        <canvas id="probaSamobojczaChart"></canvas>
    </div>

    <script>
        // Funkcja do tworzenia wykresu
        function createChart(ctx, labels, data, title) {
            const colors = ['#ffcccb', '#add8e6', '#90ee90']; // Kolory dla odpowiedzi
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: title,
                        data: data,
                        backgroundColor: colors,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            suggestedMax: 50 // Maksymalna wartość na osi Y
                        }
                    }
                }
            });
        }

        // Dane dla wykresów (przekazane z widoku)
        const wiekLabels = {{ wiek_labels|safe }};
        const wiekData = {{ wiek_data|safe }};
        const poczucieSmutkuLabels = {{ poczucie_smutku_labels|safe }};
        const poczucieSmutkuData = {{ poczucie_smutku_data|safe }};
        const nerwoweZachowanieLabels = {{ nerwowe_zachowanie_labels|safe }};
        const nerwoweZachowanieData = {{ nerwowe_zachowanie_data|safe }};
        const problemyZeSpaniemLabels = {{ problemy_ze_spaniem_labels|safe }};
        const problemyZeSpaniemData = {{ problemy_ze_spaniem_data|safe }};
        const problemyZKoncentracjaLabels = {{ problemy_z_koncentracja_labels|safe }};
        const problemyZKoncentracjaData = {{ problemy_z_koncentracja_data|safe }};
        const przejadanieSieLabels = {{ przejadanie_sie_labels|safe }};
        const przejadanieSieData = {{ przejadanie_sie_data|safe }};
        const poczucieWinyLabels = {{ poczucie_winy_labels|safe }};
        const poczucieWinyData = {{ poczucie_winy_data|safe }};
        const problemZPrzywiazaniemLabels = {{ problem_z_przywiazaniem_labels|safe }};
        const problemZPrzywiazaniemData = {{ problem_z_przywiazaniem_data|safe }};
        const probaSamobojczaLabels = {{ proba_samobojcza_labels|safe }};
        const probaSamobojczaData = {{ proba_samobojcza_data|safe }};

        // Przetłumacz odpowiedzi
        const translateLabels = (labels) => {
            return labels.map(label => {
                if (label === 0) return 'Nie';
                else if (label === 1) return 'Czasami';
                else return 'Tak';
            });
        }

        // Tworzenie wykresów
        createChart(document.getElementById('wiekChart').getContext('2d'), translateLabels(wiekLabels), wiekData, 'Wiek');
        createChart(document.getElementById('poczucieSmutkuChart').getContext('2d'), translateLabels(poczucieSmutkuLabels), poczucieSmutkuData, 'Poczucie Smutku');
        createChart(document.getElementById('nerwoweZachowanieChart').getContext('2d'), translateLabels(nerwoweZachowanieLabels), nerwoweZachowanieData, 'Nerwowe Zachowanie');
        createChart(document.getElementById('problemyZeSpaniemChart').getContext('2d'), translateLabels(problemyZeSpaniemLabels), problemyZeSpaniemData, 'Problemy ze Spaniem');
        createChart(document.getElementById('problemyZKoncentracjaChart').getContext('2d'), translateLabels(problemyZKoncentracjaLabels), problemyZKoncentracjaData, 'Problemy z Koncentracją');
        createChart(document.getElementById('przejadanieSieChart').getContext('2d'), translateLabels(przejadanieSieLabels), przejadanieSieData, 'Przejadanie Się');
        createChart(document.getElementById('poczucieWinyChart').getContext('2d'), translateLabels(poczucieWinyLabels), poczucieWinyData, 'Poczucie Winy');
        createChart(document.getElementById('problemZPrzywiazaniemChart').getContext('2d'), translateLabels(problemZPrzywiazaniemLabels), problemZPrzywiazaniemData, 'Problem z Przywiązaniem');
        createChart(document.getElementById('probaSamobojczaChart').getContext('2d'), translateLabels(probaSamobojczaLabels), probaSamobojczaData, 'Próba Samobójcza');
    </script>
</body>
</html>

{% endblock %}
